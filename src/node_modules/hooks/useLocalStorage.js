import {useEffect, useState} from 'react'
import useAuthChecker from 'hooks/useAuthChecker'

export default (key, initialValue = '') => {
  const [user, setUser] = useState({})
  const [response] = useAuthChecker()
  const [value, setValue] = useState(() => {
    return localStorage.getItem(key) || initialValue
  })

  useEffect(() => {
    setUser(response)
  }, [response])

  useEffect(() => {
    if (user) {
      localStorage.setItem(key, JSON.stringify({
        uid: user.uid,
        username: user.username,
        email: user.email
      }))
    }
  }, [value, key, user])

  return [value, setValue]
}
